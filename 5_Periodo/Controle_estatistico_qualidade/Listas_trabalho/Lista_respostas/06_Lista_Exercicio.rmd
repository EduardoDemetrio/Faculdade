---
title: "Eduardo Demetrio"
author: "Controle estatistisco de qualidade"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: cosmo
    highlight: tango
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: paged
    css: style.css

---
# Reposit√≥rio.
- Teremos tamb√©m um reposit√≥rio com todas listas no GitHub.
[üîó Reposit√≥rio no GitHub]()

## Quest√£o 1
*Um gr√°fico x √© estabelecido com base nos par√¢metros ¬µ = 600 e œÉ = 12, com n = 9, baseado num risco do erro do tipo I (Œ± = 0.01). Quais s√£o os limites de controle?
```{r, echo=FALSE}
# Par√¢metros
mu <- 600
sigma <- 12
n <- 9
alpha <- 0.01

# C√°lculo do erro padr√£o da m√©dia
sigma_xbar <- sigma / sqrt(n)

# Valor cr√≠tico da normal padr√£o (para Œ± = 0.01 ‚Üí 0.005 em cada cauda)
z_alpha <- qnorm(1 - alpha / 2)

# Limites de controle
LIC <- mu - z_alpha * sigma_xbar
LSC <- mu + z_alpha * sigma_xbar

# Resultados
LIC
LSC

```


## Quest√£o 2
Gr√°ficos de controle 3-sigma X e S s√£o aplicados para monitorar o controle estat√≠stico de um processo.
O tamanho amostral √© n = 6. Os limites dos gr√°ficos de controle s√£o os seguintes:

a) Estime a m√©dia e o desvio padr√£o do processo; Resposta: ¬µÀÜ0 = 706; œÉÀÜ0 = 1, 7963.
b) Assuma que a vari√°vel monitorada tenha distribui√ß√£o normal. Se as especifica√ß√µes s√£o 703 e 709, estime a probabilidade de produ√ß√£o fora das especifica√ß√µes; Resposta: PPFE=0,095.
c) Suponha que a m√©dia do processo mude para 707, e o desvio padr√£o permane√ßa o mesmo. Qual a probabilidade de um ponto fora dos limites de controle logo na pr√≥xima amostra? Resposta:
p = 0, 05.

```{r, echo=FALSE}
# Limites do gr√°fico x-barra
LIC_x <- 703.80
LC_x <- 706.00
LSC_x <- 708.20

# Limites do gr√°fico s
LIC_s <- 0.051
LC_s <- 1.709
LSC_s <- 3.367

# Tamanho da amostra
n <- 6
# Estimativa da m√©dia do processo
mu_0 <- LC_x

# Estimativa do desvio padr√£o do processo
# Para gr√°fico s: LC_s = c4(n) * sigma
# Tabela de c4 para n = 6: c4 = 0.9213 (Montgomery, 7¬™ ed.)

c4 <- 0.9213
sigma_0 <- LC_s / c4

mu_0
sigma_0


# Especifica√ß√µes
LS <- 709
LI <- 703

# C√°lculo da PPFE
prob_baixo <- pnorm(LI, mean = mu_0, sd = sigma_0)
prob_cima  <- 1 - pnorm(LS, mean = mu_0, sd = sigma_0)
ppfe <- prob_baixo + prob_cima

ppfe


# Erro padr√£o da m√©dia
sigma_xbar <- sigma_0 / sqrt(n)

# Probabilidade de cair abaixo do LIC ou acima do LSC
p_abaixo <- pnorm(LIC_x, mean = 707, sd = sigma_xbar)
p_acima <- 1 - pnorm(LSC_x, mean = 707, sd = sigma_xbar)
p_fora <- p_abaixo + p_acima

p_fora


```
## Quest√£o 3
Amostras de tamanho n = 5 s√£o extra√≠das de um processo de manufatura a cada hora. Uma caracter√≠stica da qualidade √© medida e x e R s√£o calculados a cada amostra. Ap√≥s a sele√ß√£o de 25 amostras,
foram obtidos:
a) Determine os limites de controle para os gr√°ficos x e R; Resposta: (LIC = 26.293, LSC = 26.707
para o gr√°fico x; LIC = 0, LSC = 0.7611 para o gr√°fico R).
b) Assuma que ambos os gr√°ficos exibam controle. Se as especifica√ß√µes s√£o 26.40 ¬± 0.50, estime a
probabilidade de produ√ß√£o fora das especifica√ß√µes; Resposta: PPFE = 0.0047;
c) Se a m√©dia do processo fosse 26.40, qual seria a probabilidade de produ√ß√£o fora das especifica√ß√µes?
Resposta: PPFE = 0.0012.
```{r, echo=FALSE}
# N√∫mero de amostras
m <- 25

# Tamanho da amostra
n <- 5

# Soma das m√©dias e das amplitudes
soma_xbar <- 662.5
soma_R <- 9.0

# M√©dias amostrais
xbar_medio <- soma_xbar / m
R_medio <- soma_R / m

xbar_medio
R_medio

A2 <- 0.577
D3 <- 0
D4 <- 2.114

# Limites para gr√°fico x-barra
LIC_x <- xbar_medio - A2 * R_medio
LC_x <- xbar_medio
LSC_x <- xbar_medio + A2 * R_medio

# Limites para gr√°fico R
LIC_R <- D3 * R_medio
LC_R <- R_medio
LSC_R <- D4 * R_medio

# Resultados
LIC_x; LC_x; LSC_x
LIC_R; LC_R; LSC_R

d2 <- 2.326
sigma_hat <- R_medio / d2

LI <- 25.90
LS <- 26.90

prob_baixo <- pnorm(LI, mean = xbar_medio, sd = sigma_hat)
prob_cima  <- 1 - pnorm(LS, mean = xbar_medio, sd = sigma_hat)
ppfe <- prob_baixo + prob_cima

ppfe

mu_novo <- 26.40

prob_baixo_2 <- pnorm(LI, mean = mu_novo, sd = sigma_hat)
prob_cima_2  <- 1 - pnorm(LS, mean = mu_novo, sd = sigma_hat)
ppfe_novo <- prob_baixo_2 + prob_cima_2

ppfe_novo


```
## Quest√£o 4
Os dados aprsentados na sequ√™ncia referem-se aos desvios das espessuras de moldes met√°licos em rela√ß√£o √† espessura nominal (determinada no projeto), verificados em 30 amostras de tamanho n = 6.
As primeiras m = 20 amostras comp√µem a fase 1 do controle do processo, utilizadas na estima√ß√£o dos par√¢metros e determina√ß√£o dos limites dos gr√°ficos de controle. As demais amostras foram selecionadas para fins de monitoramento, compondo a segunda fase.

a) Forne√ßa estimativas n√£o viciadas para a m√©dia e o desvio padr√£o do processo (baseadas nas amplitudes e nos desvios padr√µes amostrais);
b) Determine os limites de controle e de alerta para os gr√°ficos x e R; o mesmo para o par de gr√°ficos x e S;
c) Escolha um par de gr√°ficos, a seu crit√©rio. Esboce o par de gr√°ficos usando os resultados da primeira fase. H√° algum indicativo de descontrole?
d) Adicione aos gr√°ficos do item anterior os resultados das dez amostras da segunda fase. H√° algum indicativo de descontrole? Verifique a ocorr√™ncia de alguma das regras sensibilizantes.
e) O gerente da empresa solicitou a voc√™ um relat√≥rio da an√°lise, descrevendo, brevemente, a metodologia utilizada, a constru√ß√£o dos gr√°ficos, os principais resultados e suas recomenda√ß√µes. Providencie o relat√≥rio.

``` {r, echo=FALSE}
dados <- data.frame(
  amostra = 1:30,
  media = c(0.0143, 0.0183, -0.0278, 0.0112, -0.0040, -0.0078, 0.0042, -0.0077, 0.0003, 0.0050,
            0.0153, -0.0025, 0.0007, -0.0177, -0.0165, -0.0113, -0.0188, 0.0242, 0.0010,-0.0332,
            -0.0420, 0.0223, -0.0103, -0.0048, 0.0025, -0.0357, 0.0562, 0.0117, 0.0580, 0.0687),
  R = c(0.119, 0.114, 0.156, 0.167, 0.158, 0.128, 0.215, 0.102, 0.198, 0.148,
        0.070, 0.104, 0.090, 0.172, 0.067, 0.118, 0.119, 0.113, 0.159, 0.209,
        0.087, 0.168, 0.152, 0.157, 0.230, 0.215, 0.227, 0.215, 0.413, 0.110),
  S = c(0.0441, 0.0374, 0.0538, 0.0612, 0.0557, 0.0453, 0.0846, 0.0399, 0.0668, 0.0587,
        0.0257, 0.0354, 0.0382, 0.0597, 0.0265, 0.0469, 0.0526, 0.0394, 0.0537, 0.0762,
        0.0301, 0.0637, 0.0568, 0.0565, 0.0818, 0.0817, 0.0840, 0.0880, 0.1640, 0.0472)
)
fase1 <- dados[1:20, ]
fase2 <- dados[21:30, ]

# Estimativas com base na Fase 1
xbar_barra <- mean(fase1$media)
R_barra <- mean(fase1$R)
S_barra <- mean(fase1$S)

# Constantes para n = 6 (Montgomery)
d2 <- 2.534
c4 <- 0.9213

# Estimativas de sigma
sigma_R <- R_barra / d2
sigma_S <- S_barra / c4

xbar_barra
sigma_R
sigma_S
 # Constantes para n = 6
A2 <- 0.483
D3 <- 0.000
D4 <- 2.114
A3 <- 0.729
B3 <- 0.03
B4 <- 1.97

# Limites para gr√°fico x-R
LIC_x_R <- xbar_barra - A2 * R_barra
LC_x_R  <- xbar_barra
LSC_x_R <- xbar_barra + A2 * R_barra

LIC_R <- D3 * R_barra
LC_R  <- R_barra
LSC_R <- D4 * R_barra

# Limites para gr√°fico x-S
LIC_x_S <- xbar_barra - A3 * S_barra
LC_x_S  <- xbar_barra
LSC_x_S <- xbar_barra + A3 * S_barra

LIC_S <- B3 * S_barra
LC_S  <- S_barra
LSC_S <- B4 * S_barra

plot(fase1$media, type = "b", pch = 19, ylim = range(c(LIC_x_R, LSC_x_R)), main = "Gr√°fico x-barra (Fase 1)",
     xlab = "Amostra", ylab = "M√©dia")
abline(h = c(LIC_x_R, LC_x_R, LSC_x_R), col = c("red", "blue", "red"), lty = c(2, 1, 2))
plot(fase1$R, type = "b", pch = 19, ylim = range(c(LIC_R, LSC_R)), main = "Gr√°fico R (Fase 1)",
     xlab = "Amostra", ylab = "Amplitude")
abline(h = c(LIC_R, LC_R, LSC_R), col = c("red", "blue", "red"), lty = c(2, 1, 2))
plot(dados$media, type = "b", pch = 19, ylim = range(c(LIC_x_R, LSC_x_R)), main = "Gr√°fico x-barra (Fase 1 + Fase 2)",
     xlab = "Amostra", ylab = "M√©dia")
abline(h = c(LIC_x_R, LC_x_R, LSC_x_R), col = c("red", "blue", "red"), lty = c(2, 1, 2))
plot(dados$R, type = "b", pch = 19, ylim = range(c(LIC_R, LSC_R)), main = "Gr√°fico R (Fase 1 + Fase 2)",
     xlab = "Amostra", ylab = "Amplitude")
abline(h = c(LIC_R, LC_R, LSC_R), col = c("red", "blue", "red"), lty = c(2, 1, 2))
cat("**Relat√≥rio Final**\n\n")
cat("Foram utilizados dados de 30 amostras, sendo 20 na Fase 1 e 10 na Fase 2.\n\n")
cat("Os gr√°ficos de controle \u0078-barra e R foram constru√≠dos com base nas estimativas:\n")
cat(sprintf("- M√©dia do processo estimada: %.4f\n", xbar_barra))
cat(sprintf("- Desvio padr√£o estimado por R: %.4f\n", sigma_R))
cat("Os limites de controle foram calculados utilizando as constantes apropriadas de Montgomery (2016).\n\n")
cat("A an√°lise gr√°fica da Fase 1 mostra um processo aparentemente sob controle.\n")
cat("Na Fase 2, foram identificados poss√≠veis ind√≠cios de descontrole em algumas amostras, especialmente pela amplitude elevada na amostra 29.\n")
cat("Recomenda-se investigar as causas especiais associadas √†s amostras fora dos limites e aplicar a√ß√µes corretivas conforme necess√°rio.\n")




```
## Quest√£o 5
Uma camada de fio isolante √© depositada sobre um substrato usando uma m√°quina. A caracter√≠stica da qualidade √© a espessura da camada de fio (em Angstroms). Na p√°gina da disciplina est√£o dispon√≠veis dados de m = 20 amostras referentes √† fase 1 e 10 amostras adicionais para monitoramento, todas com tamanho n = 4 (bases IsolanteF1.csv e IsolanteF2.csv dispon√≠veis na p√°gina da disciplina).

```{r, echo=FALSE}
library(qcc)  
knitr::opts_chunk$set(echo = FALSE)
# Substitua pelos caminhos reais se estiver usando fora do ambiente da disciplina
caminho_f1 <- "C:/Users/edude/OneDrive/√Årea de Trabalho/C√≥digos/Faculdade/5_Periodo/Controle_estatistico_qualidade/Listas_trabalho/Lista_respostas/IsolanteF1.csv"
caminho_f2 <- "C:/Users/edude/OneDrive/√Årea de Trabalho/C√≥digos/Faculdade/5_Periodo/Controle_estatistico_qualidade/Listas_trabalho/Lista_respostas/IsolanteF2.csv"

# Leitura dos arquivos
fase1 <- read.csv2(caminho_f1, header = TRUE)
fase2 <- read.csv2(caminho_f2, header = TRUE)

head(fase1)
# Converter dados para matriz (cada linha = uma amostra)
matriz_f1 <- as.matrix(fase1)

# Criar gr√°fico de controle x-barra e R
controle_f1 <- qcc(matriz_f1, type = "xbar", plot = TRUE)
controle_r <- qcc(matriz_f1, type = "R", plot = TRUE)

# Converter para matriz
matriz_f2 <- as.matrix(fase2)

# Atualizar o gr√°fico com novos pontos
qcc_update <- qcc(matriz_f1, type = "xbar", newdata = matriz_f2)

# Estimar par√¢metros do processo com base na Fase 1
media_proc <- mean(matriz_f1)
desvio_proc <- sd(as.vector(matriz_f1))  # com todos os dados amostrais

# Calcular PPFE
ppfe_inf <- pnorm(420, mean = media_proc, sd = desvio_proc)
ppfe_sup <- 1 - pnorm(480, mean = media_proc, sd = desvio_proc)
ppfe_total <- ppfe_inf + ppfe_sup

ppfe_total

cat("**Conclus√£o:**\n\n")
cat(sprintf("O processo apresenta uma m√©dia estimada de %.2f e desvio padr√£o de %.2f com base na Fase 1.\n", media_proc, desvio_proc))
cat("A constru√ß√£o dos gr√°ficos de controle indica se h√° ind√≠cios de descontrole durante a Fase 2.\n")
cat(sprintf("A probabilidade estimada de produ√ß√£o fora das especifica√ß√µes (PPFE) √© de aproximadamente %.2f%%.\n", 100 * ppfe_total))

```


## Quest√£o 6
Pe√ßas fabricadas por processo de moldagem por inje√ß√£o s√£o submetidas a um ensaio de resist√™ncia √† compress√£o. Vinte amostras de cinco partes cada s√£o coletadas e as resist√™ncia √† compress√£o (em psi) s√£o registradas. Adicionalmente, quinze amostras s√£o selecionadas na segunda fase, para monitoramento do processo (bases CompF1.csv e CompF2.csv dispon√≠veis na p√°gina da disciplina). Procedacom a constru√ß√£o e an√°lise dos gr√°ficos de controle x e S.

```{r, echo=FALSE}
library(qcc)  # <- ESSENCIAL para usar qcc()
knitr::opts_chunk$set(echo = FALSE)
# Ajuste seu caminho conforme sua m√°quina
base_dir <- "C:/Users/edude/OneDrive/√Årea de Trabalho/C√≥digos/Faculdade/5_Periodo/Controle_estatistico_qualidade/Listas_trabalho/Lista_respostas"

# Carregar arquivos
fase1 <- read.csv2(file.path(base_dir, "CompF1.csv"), header = TRUE)
fase2 <- read.csv2(file.path(base_dir, "CompF2.csv"), header = TRUE)

# Visualizar
head(fase1)

# Converter em matriz (cada linha = uma amostra)
matriz_f1 <- as.matrix(fase1)

# Gr√°fico x-barra com desvio padr√£o amostral ponderado
qcc_xs <- qcc(matriz_f1, type = "xbar", std.dev = "UWAVE-SD", plot = TRUE)

# Gr√°fico S (desvios padr√£o)
qcc_s <- qcc(matriz_f1, type = "S", plot = TRUE)

# Converter a fase 2 em matriz
matriz_f2 <- as.matrix(fase2)

# Atualizar gr√°fico x-barra com fase 2
qcc_xs_monitor <- qcc(matriz_f1, type = "xbar", std.dev = "UWAVE-SD", newdata = matriz_f2, plot = TRUE)


cat("**Conclus√£o:**\n\n")
cat("Os gr√°ficos \u0078-barra e S foram constru√≠dos usando as 20 amostras da Fase 1.\n")
cat("A avalia√ß√£o dos gr√°ficos mostra se o processo estava sob controle inicialmente.\n")
cat("Ap√≥s incluir as 15 amostras da Fase 2, observamos se algum ponto ultrapassa os limites de controle.\n")
cat("Se sim, isso indica uma poss√≠vel causa especial e necessidade de investiga√ß√£o do processo.\n")
```

## Quest√£o 7
A uniformidade de uma pastilha de sil√≠cio ap√≥s rea√ß√£o qu√≠mica √© determinada pela medi√ß√£o da espessura em v√°rias posi√ß√µes, expressando a uniformidade como a amplitude das espessuras.
Parte 1- Disp√µe-se das medidas individuais de uniformidade para uma sequ√™ncia de 30 pastilhas produzidas.
Parte 2- Tem-se tamb√©m os dados adicionais sobre 10 pastilhas produzidas. Com base nesses resultados, o processo parece estar sobre controle?
Parte 3- Suponha que a causa atribu√≠vel respons√°vel pelo sinal de descontrole tenha sido identificada e eliminada do processo. O monitoramento do processo teve sequ√™ncia com a sele√ß√£o de outras 20 amostras unit√°rias. Usando os limites de controle estabelecidos na primeira parte do exerc√≠cio. Quais as suas conclus√µes?
Bases past.csv, past2.csv e past3.csv dispon√≠veis na p√°gina da disciplina.


```{r, echo=FALSE}

library(qcc)  # <- ESSENCIAL para usar qcc()
knitr::opts_chunk$set(echo = FALSE)
# Caminho onde est√£o os arquivos
base_dir <- "C:/Users/edude/OneDrive/√Årea de Trabalho/C√≥digos/Faculdade/5_Periodo/Controle_estatistico_qualidade/Listas_trabalho/Lista_respostas"

# Leitura dos arquivos (dados individuais)
past1 <- read.csv2(file.path(base_dir, "past.csv"), header = TRUE)
past2 <- read.csv2(file.path(base_dir, "past2.csv"), header = TRUE)
past3 <- read.csv2(file.path(base_dir, "past3.csv"), header = TRUE)

# Extrair vetor com os valores (supondo 1 coluna com dados)
dados1 <- past1[[1]]

# Gr√°fico de controle para dados individuais
qcc_x <- qcc(dados1, type = "xbar.one", plot = TRUE)

dados2 <- past2[[1]]

# Adicionar ao gr√°fico
qcc_x_monitor <- qcc(dados1, type = "xbar.one", newdata = dados2, plot = TRUE)

dados3 <- past3[[1]]

# Adicionar dados da Parte 3 ao gr√°fico com os limites da Parte 1
qcc_x_final <- qcc(dados1, type = "xbar.one", newdata = dados3, plot = TRUE)

cat("**Conclus√µes da Quest√£o 7:**\n\n")
cat("**Parte 1:** Os gr√°ficos individuais mostraram os limites de controle com base nas 30 primeiras pastilhas.\n")
cat("**Parte 2:** Foram avaliadas 10 novas pastilhas. Caso alguma delas tenha ultrapassado os limites, h√° ind√≠cio de descontrole.\n")
cat("**Parte 3:** Ap√≥s a remo√ß√£o da causa especial, o processo foi monitorado com 20 novas pastilhas.\n")
cat("Se todas estiverem dentro dos limites e sem padr√£o sistem√°tico, o processo est√° sob controle.\n")
```


## Quest√£o 8
Considere a constru√ß√£o de gr√°ficos de controle para a resist√™ncia √† tra√ß√£o de cabos de a√ßo. A fase 1 foi planejada para m = 15 amostras de tamanho n = 6. No entanto, em cinco delas apenas n = 5 cabos estavam dispon√≠veis. Para a segunda fase, tendo em vista a dificuldade em atender o tamanho amostral inicialmente planejado, optou-se por fixar n = 4. A vari√°vel analisada foi a carga de ruptura (em kg/mm2). As √∫ltimas 10 amostras correspondem √† fase 2.

```{r, echo=FALSE}
library(qcc)  # <- ESSENCIAL para usar qcc()
knitr::opts_chunk$set(echo = TRUE)

fase1 <- data.frame(
  A1  = c(194, 200, 200, 197, 203, 186, 210, 206, 201, 202, 205, 188, 207, 200, 198),
  A2  = c(217, 203, 196, 209, 214, 212, 178, 204, 200, 214, 212, 199, 198, 195, 190),
  A3  = c(195, 204, 192, 216, 183, 205, 183, 186, 183, 184, 199, 197, 192, 208, 196),
  A4  = c(201, 193, 188, 211, 206, 195, 221, 193, 191, 199, 198, 209, 203, 199, 191),
  A5  = c(207, 205, 211, 183, 191, 194, 210, 205, 223, 192, 203, 204, 192, 203, 204),
  A6  = c(203, 216, 179, 198, NA, 198, 204, NA, 203, NA, 201, NA, 210, NA, 201)
)

# Fase 2 (10 amostras, n = 4)
fase2 <- data.frame(
  A1 = c(198, 177, 227, 197, 188, 177, 196, 167, 199, 190),
  A2 = c(191, 197, 211, 200, 186, 188, 191, 193, 202, 202),
  A3 = c(212, 212, 211, 202, 213, 183, 217, 193, 184, 208),
  A4 = c(177, 211, 203, 230, 212, 182, 186, 204, 181, 219),
  A5 = rep(NA, 10),
  A6 = rep(NA, 10)
)
qcc_xs <- qcc(fase1, type = "xbar", std.dev = "UWAVE-SD", plot = TRUE)
qcc_s <- qcc(fase1, type = "S", plot = TRUE)
qcc_xs_monitor <- qcc(fase1, type = "xbar", std.dev = "UWAVE-SD", newdata = fase2, plot = TRUE)
cat("**Conclus√£o:**\n\n")
cat("Os gr√°ficos \u0078-barra e S foram constru√≠dos com base nas 15 amostras da Fase 1, com diferentes tamanhos amostrais (5 ou 6).\n")
cat("A Fase 2, com amostras de tamanho 4, foi adicionada para monitoramento.\n")
cat("Se houver pontos fora dos limites ou padr√µes suspeitos, isso indica descontrole estat√≠stico.\n")

```